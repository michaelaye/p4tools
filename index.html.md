# p4tools


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

<figure>
<a href="https://pypi.python.org/pypi/p4tools"><img
src="https://img.shields.io/pypi/v/p4tools.svg"
alt="PyPI version" /></a>
<figcaption>PyPI version</figcaption>
</figure>

## Installation

``` bash
pip install p4tools
```

## Features

- Provide easy access to the Planet Four catalog data.
  - Data will be automatically downloaded and cached by the `pooch`
    library.
  - The first time it will take a few seconds to download the data, the
    next time it will be using the cache.
- Provide automatic downloading of the png tiles of the catalog.
- Provide plotting tools

> Note: The original data for input to the Planet Four projects were
> these `_COLOR` products like this one:
> https://hirise-pds.lpl.arizona.edu/PDS/EXTRAS/RDR/ESP/ORB_011400_011499/ESP_011486_0980/ESP_011486_0980_IRB.NOMAP.browse.jpg
> (not the browse product though, but the full size of course)

## Paper

The underlying paper for this work is:

> Aye, K.-M., Schwamb, M.E., Portyankina, G., Hansen, C.J., McMaster,
> A., Miller, G.R.M., Carstensen, B., Snyder, C., Parrish, M., Lynn, S.,
> Mai, C., Miller, D., Simpson, R.J., Smith, A.M., 2019. Planet Four:
> Probing springtime winds on Mars by mapping the southern polar CO2 jet
> deposits. Icarus 319, 558–598.
> https://doi.org/10.1016/j.icarus.2018.08.018

``` python
from p4tools import io
```

``` python
# get the catalogs
fans = io.get_fan_catalog()
blotches = io.get_blotch_catalog()
fans.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">marking_id</th>
<th data-quarto-table-cell-role="th">angle</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">tile_id</th>
<th data-quarto-table-cell-role="th">image_x</th>
<th data-quarto-table-cell-role="th">image_y</th>
<th data-quarto-table-cell-role="th">n_votes</th>
<th data-quarto-table-cell-role="th">obsid</th>
<th data-quarto-table-cell-role="th">spread</th>
<th data-quarto-table-cell-role="th">version</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">y_angle</th>
<th data-quarto-table-cell-role="th">l_s</th>
<th data-quarto-table-cell-role="th">map_scale</th>
<th data-quarto-table-cell-role="th">north_azimuth</th>
<th data-quarto-table-cell-role="th">BodyFixedCoordinateX</th>
<th data-quarto-table-cell-role="th">BodyFixedCoordinateY</th>
<th data-quarto-table-cell-role="th">BodyFixedCoordinateZ</th>
<th data-quarto-table-cell-role="th">PlanetocentricLatitude</th>
<th data-quarto-table-cell-role="th">PlanetographicLatitude</th>
<th data-quarto-table-cell-role="th">Longitude</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">0</td>
<td>F000000</td>
<td>205.56</td>
<td>179.71</td>
<td>APF0000ci9</td>
<td>2270.76</td>
<td>24336.16</td>
<td>35</td>
<td>ESP_012079_0945</td>
<td>88.03</td>
<td>1</td>
<td>...</td>
<td>-0.43</td>
<td>214.785</td>
<td>0.25</td>
<td>126.856883</td>
<td>-65.804336</td>
<td>261.407884</td>
<td>-3370.504345</td>
<td>-85.427383</td>
<td>-85.480829</td>
<td>104.129523</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">1</td>
<td>F000001</td>
<td>185.39</td>
<td>179.62</td>
<td>APF0000cia</td>
<td>3391.21</td>
<td>5640.60</td>
<td>15</td>
<td>ESP_012079_0945</td>
<td>21.35</td>
<td>1</td>
<td>...</td>
<td>-0.09</td>
<td>214.785</td>
<td>0.25</td>
<td>126.856883</td>
<td>-67.219114</td>
<td>257.011589</td>
<td>-3370.631413</td>
<td>-85.493546</td>
<td>-85.546226</td>
<td>104.656897</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">2</td>
<td>F000002</td>
<td>184.98</td>
<td>500.27</td>
<td>APF0000cia</td>
<td>3509.96</td>
<td>5876.70</td>
<td>10</td>
<td>ESP_012079_0945</td>
<td>18.91</td>
<td>1</td>
<td>...</td>
<td>-0.09</td>
<td>214.785</td>
<td>0.25</td>
<td>126.856883</td>
<td>-67.170611</td>
<td>257.055226</td>
<td>-3370.630794</td>
<td>-85.493039</td>
<td>-85.545725</td>
<td>104.644396</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">3</td>
<td>F000004</td>
<td>184.29</td>
<td>105.43</td>
<td>APF0000cia</td>
<td>3716.27</td>
<td>5824.50</td>
<td>6</td>
<td>ESP_012079_0945</td>
<td>26.41</td>
<td>1</td>
<td>...</td>
<td>-0.07</td>
<td>214.785</td>
<td>0.25</td>
<td>126.856883</td>
<td>-67.127761</td>
<td>257.024926</td>
<td>-3370.635002</td>
<td>-85.493723</td>
<td>-85.546401</td>
<td>104.637107</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">4</td>
<td>F000005</td>
<td>189.42</td>
<td>109.50</td>
<td>APF0000cia</td>
<td>3452.17</td>
<td>6033.00</td>
<td>3</td>
<td>ESP_012079_0945</td>
<td>22.58</td>
<td>1</td>
<td>...</td>
<td>-0.16</td>
<td>214.785</td>
<td>0.25</td>
<td>126.856883</td>
<td>-67.169940</td>
<td>257.096267</td>
<td>-3370.628302</td>
<td>-85.492368</td>
<td>-85.545061</td>
<td>104.642019</td>
</tr>
</tbody>
</table>

<p>5 rows × 24 columns</p>
</div>

``` python
# get fans for a given tile_id
fans_for_tile = io.get_fans_for_tile("APF0000cro")
fans_for_tile.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">marking_id</th>
<th data-quarto-table-cell-role="th">angle</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">tile_id</th>
<th data-quarto-table-cell-role="th">image_x</th>
<th data-quarto-table-cell-role="th">image_y</th>
<th data-quarto-table-cell-role="th">n_votes</th>
<th data-quarto-table-cell-role="th">obsid</th>
<th data-quarto-table-cell-role="th">spread</th>
<th data-quarto-table-cell-role="th">version</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">y_angle</th>
<th data-quarto-table-cell-role="th">l_s</th>
<th data-quarto-table-cell-role="th">map_scale</th>
<th data-quarto-table-cell-role="th">north_azimuth</th>
<th data-quarto-table-cell-role="th">BodyFixedCoordinateX</th>
<th data-quarto-table-cell-role="th">BodyFixedCoordinateY</th>
<th data-quarto-table-cell-role="th">BodyFixedCoordinateZ</th>
<th data-quarto-table-cell-role="th">PlanetocentricLatitude</th>
<th data-quarto-table-cell-role="th">PlanetographicLatitude</th>
<th data-quarto-table-cell-role="th">Longitude</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">639</td>
<td>F00028e</td>
<td>176.82</td>
<td>357.51</td>
<td>APF0000cro</td>
<td>1904.17</td>
<td>469.07</td>
<td>30</td>
<td>ESP_012079_0945</td>
<td>29.52</td>
<td>1</td>
<td>...</td>
<td>0.06</td>
<td>214.785</td>
<td>0.25</td>
<td>126.856883</td>
<td>-68.025795</td>
<td>255.956937</td>
<td>-3370.658673</td>
<td>-85.507336</td>
<td>-85.559856</td>
<td>104.883467</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">640</td>
<td>F00028f</td>
<td>177.09</td>
<td>122.21</td>
<td>APF0000cro</td>
<td>1948.37</td>
<td>602.24</td>
<td>25</td>
<td>ESP_012079_0945</td>
<td>22.86</td>
<td>1</td>
<td>...</td>
<td>0.05</td>
<td>214.785</td>
<td>0.25</td>
<td>126.856883</td>
<td>-68.003644</td>
<td>255.983513</td>
<td>-3370.657733</td>
<td>-85.506997</td>
<td>-85.559521</td>
<td>104.877359</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">641</td>
<td>F000290</td>
<td>177.02</td>
<td>137.73</td>
<td>APF0000cro</td>
<td>1666.29</td>
<td>290.83</td>
<td>24</td>
<td>ESP_012079_0945</td>
<td>19.18</td>
<td>1</td>
<td>...</td>
<td>0.05</td>
<td>214.785</td>
<td>0.25</td>
<td>126.856883</td>
<td>-68.096623</td>
<td>255.937481</td>
<td>-3370.658914</td>
<td>-85.507347</td>
<td>-85.559867</td>
<td>104.899357</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">642</td>
<td>F000291</td>
<td>178.83</td>
<td>97.55</td>
<td>APF0000cro</td>
<td>1875.95</td>
<td>400.38</td>
<td>16</td>
<td>ESP_012079_0945</td>
<td>35.51</td>
<td>1</td>
<td>...</td>
<td>0.02</td>
<td>214.785</td>
<td>0.25</td>
<td>126.856883</td>
<td>-68.038458</td>
<td>255.943748</td>
<td>-3370.659367</td>
<td>-85.507498</td>
<td>-85.560016</td>
<td>104.886848</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">643</td>
<td>F000292</td>
<td>178.56</td>
<td>108.57</td>
<td>APF0000cro</td>
<td>2316.12</td>
<td>491.00</td>
<td>4</td>
<td>ESP_012079_0945</td>
<td>52.76</td>
<td>1</td>
<td>...</td>
<td>0.03</td>
<td>214.785</td>
<td>0.25</td>
<td>126.856883</td>
<td>-67.928961</td>
<td>255.925385</td>
<td>-3370.666710</td>
<td>-85.508282</td>
<td>-85.560791</td>
<td>104.864970</td>
</tr>
</tbody>
</table>

<p>5 rows × 24 columns</p>
</div>

### Metadata

Metadata for the HiRISE observions that were used for the input data to
the project:

``` python
# get the metadata of the HiRISE images
metadata = io.get_meta_data()
```

``` python
metadata.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">OBSERVATION_ID</th>
<th data-quarto-table-cell-role="th">IMAGE_CENTER_LATITUDE</th>
<th data-quarto-table-cell-role="th">IMAGE_CENTER_LONGITUDE</th>
<th data-quarto-table-cell-role="th">SOLAR_LONGITUDE</th>
<th data-quarto-table-cell-role="th">START_TIME</th>
<th data-quarto-table-cell-role="th">map_scale</th>
<th data-quarto-table-cell-role="th">north_azimuth</th>
<th data-quarto-table-cell-role="th"># of tiles</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">0</td>
<td>ESP_011296_0975</td>
<td>-82.1965</td>
<td>225.2530</td>
<td>178.833</td>
<td>2008-12-23 16:15:26</td>
<td>1.0</td>
<td>110.600107</td>
<td>91</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">1</td>
<td>ESP_011341_0980</td>
<td>-81.7969</td>
<td>76.1304</td>
<td>180.809</td>
<td>2008-12-27 04:25:02</td>
<td>0.5</td>
<td>110.208923</td>
<td>126</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">2</td>
<td>ESP_011348_0950</td>
<td>-85.0427</td>
<td>259.0940</td>
<td>181.117</td>
<td>2008-12-27 17:29:17</td>
<td>1.0</td>
<td>123.624057</td>
<td>91</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">3</td>
<td>ESP_011350_0945</td>
<td>-85.2160</td>
<td>181.4150</td>
<td>181.205</td>
<td>2008-12-27 21:14:01</td>
<td>0.5</td>
<td>99.672793</td>
<td>126</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">4</td>
<td>ESP_011351_0945</td>
<td>-85.2157</td>
<td>181.5480</td>
<td>181.249</td>
<td>2008-12-27 23:05:54</td>
<td>1.0</td>
<td>127.960688</td>
<td>91</td>
</tr>
</tbody>
</table>

</div>

``` python
# get the lat/lon or BodyFixedcoordinates of the tiles
coords = io.get_tile_coords()
coords.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">x_tile</th>
<th data-quarto-table-cell-role="th">y_tile</th>
<th data-quarto-table-cell-role="th">x_hirise</th>
<th data-quarto-table-cell-role="th">y_hirise</th>
<th data-quarto-table-cell-role="th">PlanetocentricLatitude</th>
<th data-quarto-table-cell-role="th">PlanetographicLatitude</th>
<th data-quarto-table-cell-role="th">PositiveEast360Longitude</th>
<th data-quarto-table-cell-role="th">BodyFixedCoordinateX</th>
<th data-quarto-table-cell-role="th">BodyFixedCoordinateY</th>
<th data-quarto-table-cell-role="th">BodyFixedCoordinateZ</th>
<th data-quarto-table-cell-role="th">tile_id</th>
<th data-quarto-table-cell-role="th">obsid</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>1</td>
<td>420.0</td>
<td>324.0</td>
<td>-85.504144</td>
<td>-85.556701</td>
<td>104.952104</td>
<td>-68.380674</td>
<td>256.056147</td>
<td>-3370.636698</td>
<td>APF0000cwz</td>
<td>ESP_012079_0945</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>2</td>
<td>420.0</td>
<td>872.0</td>
<td>-85.502300</td>
<td>-85.554878</td>
<td>104.934805</td>
<td>-68.331337</td>
<td>256.181661</td>
<td>-3370.628630</td>
<td>APF0000ck9</td>
<td>ESP_012079_0945</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>3</td>
<td>420.0</td>
<td>1420.0</td>
<td>-85.500454</td>
<td>-85.553054</td>
<td>104.917486</td>
<td>-68.281853</td>
<td>256.307249</td>
<td>-3370.620295</td>
<td>APF0000cty</td>
<td>ESP_012079_0945</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">3</td>
<td>1</td>
<td>4</td>
<td>420.0</td>
<td>1968.0</td>
<td>-85.498607</td>
<td>-85.551228</td>
<td>104.900198</td>
<td>-68.232522</td>
<td>256.433112</td>
<td>-3370.615690</td>
<td>APF0000ciy</td>
<td>ESP_012079_0945</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">4</td>
<td>1</td>
<td>5</td>
<td>420.0</td>
<td>2516.0</td>
<td>-85.496762</td>
<td>-85.549404</td>
<td>104.882968</td>
<td>-68.183281</td>
<td>256.558509</td>
<td>-3370.606455</td>
<td>APF0000cwp</td>
<td>ESP_012079_0945</td>
</tr>
</tbody>
</table>

</div>

### Image tiles

The png tiles of the HiRISE images are automatically downloaded and
cached by the `pooch` library.

``` python
# get the urls of the tiles
tile_urls = io.get_tile_urls()
tile_urls.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">tile_id</th>
<th data-quarto-table-cell-role="th">tile_url</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">0</td>
<td>APF0000coq</td>
<td>http://www.planetfour.org/subjects/standard/50...</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">1</td>
<td>APF0000cro</td>
<td>http://www.planetfour.org/subjects/standard/50...</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">2</td>
<td>APF0000cs6</td>
<td>http://www.planetfour.org/subjects/standard/50...</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">3</td>
<td>APF0000co1</td>
<td>http://www.planetfour.org/subjects/standard/50...</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">4</td>
<td>APF0000cpd</td>
<td>http://www.planetfour.org/subjects/standard/50...</td>
</tr>
</tbody>
</table>

</div>

``` python
# or get the url for a tile id
io.get_url_for_tile("APF0000cro")
```

    'http://www.planetfour.org/subjects/standard/50e742bf5e2ed212400040a4.jpg'

``` python
# get the png as numpy array:
img = io.get_subframe_for_tile("APF0000cro")
img
```

    array([[[146,   1,   8],
            [146,   1,   6],
            [145,   0,   5],
            ...,
            [116,   3,   0],
            [115,   1,   0],
            [115,   3,   1]],

           [[147,   2,   7],
            [146,   1,   6],
            [145,   0,   2],
            ...,
            [119,   1,   0],
            [119,   1,   0],
            [117,   2,   0]],

           [[145,   3,   2],
            [145,   1,   1],
            [147,   0,   0],
            ...,
            [125,   0,   0],
            [124,   0,   0],
            [125,   0,   0]],

           ...,

           [[121,  96,  76],
            [126,  99,  80],
            [127,  99,  78],
            ...,
            [125,  93,  72],
            [124,  92,  71],
            [130,  98,  77]],

           [[118,  91,  70],
            [124,  97,  76],
            [123,  95,  74],
            ...,
            [130,  98,  77],
            [125,  93,  72],
            [130,  98,  75]],

           [[111,  84,  63],
            [116,  89,  68],
            [114,  83,  63],
            ...,
            [132, 100,  79],
            [127,  95,  72],
            [133, 101,  78]]], dtype=uint8)

``` python
io.get_hirise_id_for_tile("APF0000cro")
```

    'ESP_012079_0945'

## License

MIT license

## Credits

### Developer and Maintainer

- K.-Michael Aye <kmichael.aye@gmail.com>

### Contributors

- Some ideas and concepts came from Meg Schwamb
